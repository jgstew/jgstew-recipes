{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/jgstew/jgstew-recipes/blob/main/.AutoPkgRecipe.schema.json",
  "$comment": "v0.1",
  "title": "AutoPkg Recipe YAML schema",
  "description": "A schema for validating AutoPkg Recipe YAML files. Used by check-jsonschema pre-commit hook.",
  "$ref": "#/definitions/AutoPkgRecipe",
  "definitions": {
    "AutoPkgRecipe": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "Description": {
          "type": "string"
        },
        "Identifier": {
          "allOf": [
            {"type": "string", "comment": "No Spaces Allowed", "pattern": "^[^\\s]*$"},
            {
              "type": "string",
              "comment": "prefix",
              "pattern": "com\\.github\\..+"
            }
          ]
        },
        "Input": {
          "$ref": "#/definitions/Input"
        },
        "MinimumVersion": {
          "type": "string",
          "comment": "Allow 0.0 through 3.9.9, does not support RC's",
          "pattern": "[0-3](\\.\\d){1,2}"
        },
        "ParentRecipe": {
          "type": "string",
          "comment": "No Spaces Allowed",
          "pattern": "^[^\\s]*$"
        },
        "Process": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/Process"
          }
        }
      },
      "required": ["Description", "Identifier", "Input", "MinimumVersion"],
      "title": "AutoPkgRecipe"
    },
    "Input": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "NAME": {
          "type": "string",
          "comment": "No Spaces Allowed",
          "pattern": "^[^\\s]*$"
        }
      },
      "required": ["NAME"],
      "title": "Input"
    },
    "Process": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "Processor": {
          "anyOf": [
            {"type": "string", "pattern": "^com\\.github\\.\\S+"},
            {
              "type": "string",
              "enum": [
                "AppDmgVersioner",
                "AppPkgCreator",
                "BrewCaskInfoProvider",
                "ChocolateyPackager",
                "CodeSignatureVerifier",
                "Copier",
                "CURLDownloader",
                "CURLTextSearcher",
                "DeprecationWarning",
                "DmgCreator",
                "DmgMounter",
                "EndOfCheckPhase",
                "FileCreator",
                "FileFinder",
                "FileMover",
                "FlatPkgPacker",
                "FlatPkgUnpacker",
                "GitHubReleasesInfoProvider",
                "Installer",
                "InstallFromDMG",
                "MunkiCatalogBuilder",
                "MunkiImporter",
                "MunkiInfoCreator",
                "MunkiInstallsItemsCreator",
                "MunkiOptionalReceiptEditor",
                "MunkiPkginfoMerger",
                "MunkiSetDefaultCatalog",
                "PackageRequired",
                "PathDeleter",
                "PkgCopier",
                "PkgCreator",
                "PkgExtractor",
                "PkgInfoCreator",
                "PkgPayloadUnpacker",
                "PkgRootCreator",
                "PlistEditor",
                "PlistReader",
                "SignToolVerifier",
                "SparkleUpdateInfoProvider",
                "StopProcessingIf",
                "Symlinker",
                "Unarchiver",
                "URLDownloader",
                "URLDownloaderPython",
                "URLGetter",
                "URLTextSearcher",
                "Versioner"
              ]
            }
          ]
        },
        "Arguments": {
          "$ref": "#/definitions/Arguments"
        }
      },
      "required": ["Processor"],
      "title": "Process"
    },
    "Arguments": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "url": {
          "type": "string",
          "format": "uri"
        },
        "re_pattern": {
          "type": "string"
        },
        "filename": {
          "type": "string",
          "comment": "No Spaces Allowed, Opinionated",
          "pattern": "^[^\\s]*$"
        },
        "COMPUTE_HASHES": {
          "type": "boolean"
        }
      },
      "required": [],
      "title": "Arguments"
    }
  }
}
